<!DOCTYPE html>
<html>
<head>
    <title>Add Suppliers</title>
    <link rel="stylesheet" href="../pages/AddProducts.css">
    <script>
        if (window.history.replaceState) {
            window.history.replaceState(null, null, window.location.href);
        }
    </script>
</head>
<body>
    <nav class="navbar">
        <div class="navbar-brand">UrbanFoods</div>
        <ul class="nav-links">
            <li><a href="index.html">Home</a></li>
            <li><a href="browse.html">Products</a></li>
            <li><a href="Suppliers.html">Suppliers</a></li>
            <li><a href="Orders/Orders.html">Orders</a></li>
            <li><a href="about.html">Reviews/Feedback</a></li>
        </ul>
        <div class="nav-buttons">
            <a href="../pages/Login-SignUp/Login-SignUp.html">
                <button class="sign-up-btn"> Sign Up </button>
            </a>
            <div class="button">
                <div class="button-wrapper">
                    <div class="text">CART</div>
                    <span class="icon">
                        <svg viewBox="0 0 16 16" class="bi bi-cart2" fill="currentColor" height="16" width="16" xmlns="http://www.w3.org/2000/svg">
                            <path d="M0 2.5A.5.5 0 0 1 .5 2H2a.5.5 0 0 1 .485.379L2.89 4H14.5a.5.5 0 0 1 .485.621l-1.5 6A.5.5 0 0 1 13 11H4a.5.5 0 0 1-.485-.379L1.61 3H.5a.5.5 0 0 1-.5-.5zM3.14 5l1.25 5h8.22l1.25-5H3.14zM5 13a1 1 0 1 0 0 2 1 1 0 0 0 0-2zm-2 1a2 2 0 1 1 4 0 2 2 0 0 1-4 0zm9-1a1 1 0 1 0 0 2 1 1 0 0 0 0-2zm-2 1a2 2 0 1 1 4 0 2 2 0 0 1-4 0z"></path>
                        </svg>
                    </span>
                </div>
            </div>
        </div>
    </nav>

    <main>
        <h2 class="products-tag">Add Suppliers</h2>
        <section class="product-form">
            <h2>Add New Supplier</h2>
            <form id="supplierForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="supplierId">Supplier ID:</label>
                        <input type="number" id="supplierId" name="supplierId" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="supplierName">Supplier Name:</label>
                        <input type="text" id="supplierName" name="supplierName" required>
                    </div>
        
                    <div class="form-group">
                        <label for="email">Email:</label>
                        <input type="email" id="email" name="email" required>
                    </div>
        
                    <div class="form-group">
                        <label for="phone">Phone Number:</label>
                        <input type="tel" id="phone" name="phone" pattern="[0-9]{10}" title="10-digit number (e.g., 1234567890)" required>
                    </div>
        
                    <div class="form-group">
                        <label for="address">Address:</label>
                        <input type="text" id="address" name="address" required>
                    </div>
        
                    <div class="form-group">
                        <label for="city">City:</label>
                        <input type="text" id="city" name="city" required>
                    </div>
        
                    <div class="form-group">
                        <label for="country">Country:</label>
                        <input type="text" id="country" name="country" required>
                    </div>
                </div>
                <button type="submit" class="add-button">Add Supplier</button>
            </form>
        </section>

        <style>
            .product-form {
                max-width: 800px;
                margin: 2rem auto;
                padding: 2rem;
                background: #fff;
                border-radius: 10px;
                box-shadow: 0 0 20px rgba(0,0,0,0.1);
                margin-top: 60px;
            }
            .form-grid {
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                gap: 1.5rem;
                margin-bottom: 1.5rem;
            }
            .form-group {
                display: flex;
                flex-direction: column;
            }
            .form-group label {
                margin-bottom: 0.5rem;
                font-weight: 500;
                color: #333;
            }
            .form-group input {
                padding: 0.8rem;
                border: 1px solid #ddd;
                border-radius: 4px;
                font-size: 1rem;
            }
            .add-button {
                background-color: #4CAF50;
                color: white;
                padding: 1rem 2rem;
                border: none;
                border-radius: 4px;
                cursor: pointer;
                font-size: 1.1rem;
                width: 100%;
                transition: background-color 0.3s;
            }
            .add-button:hover {
                background-color: #45a049;
            }
            @media (max-width: 768px) {
                .form-grid {
                    grid-template-columns: 1fr;
                }
            }
        </style>

        <script>
            const supplierUrl = "http://localhost:8080/api/suppliers";

            document.getElementById("supplierForm").addEventListener("submit", async function (e) {
                e.preventDefault();

                const supplierData = {
                    supplierId: parseInt(document.getElementById("supplierId").value),
                    supplierName: document.getElementById("supplierName").value,
                    email: document.getElementById("email").value,
                    phone: document.getElementById("phone").value,
                    address: document.getElementById("address").value,
                    city: document.getElementById("city").value,
                    country: document.getElementById("country").value
                };

                try {
                    const response = await fetch(supplierUrl, {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json"
                        },
                        body: JSON.stringify(supplierData)
                    });

                    if (response.ok) {
                        alert("Supplier added successfully!");
                        document.getElementById("supplierForm").reset();
                    } else {
                        const errorData = await response.json();
                        alert("Error: " + (errorData.message || "Failed to add supplier"));
                    }
                } catch (error) {
                    console.error("Error submitting form:", error);
                    alert("Error: Could not connect to server");
                }
            });
        </script>
    </main>
</body>
</html>
